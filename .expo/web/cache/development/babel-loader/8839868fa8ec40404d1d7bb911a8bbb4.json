{"ast":null,"code":"var _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _expoModulesCore = require(\"expo-modules-core\");\n\nfunction getUserMedia(constraints) {\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n\n  var getUserMedia = navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || function () {\n    var error = new Error('Permission unimplemented');\n    error.code = 0;\n    error.name = 'NotAllowedError';\n    throw error;\n  };\n\n  return new Promise(function (resolve, reject) {\n    getUserMedia.call(navigator, constraints, resolve, reject);\n  });\n}\n\nfunction handleGetUserMediaError(_ref) {\n  var message = _ref.message;\n\n  if (message === 'Permission dismissed') {\n    return {\n      status: _expoModulesCore.PermissionStatus.UNDETERMINED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: false\n    };\n  } else {\n    return {\n      status: _expoModulesCore.PermissionStatus.DENIED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: false\n    };\n  }\n}\n\nfunction handleRequestPermissionsAsync() {\n  return _handleRequestPermissionsAsync.apply(this, arguments);\n}\n\nfunction _handleRequestPermissionsAsync() {\n  _handleRequestPermissionsAsync = (0, _asyncToGenerator2.default)(function* () {\n    try {\n      yield getUserMedia({\n        video: true\n      });\n      return {\n        status: _expoModulesCore.PermissionStatus.GRANTED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: true\n      };\n    } catch (_ref2) {\n      var message = _ref2.message;\n      return handleGetUserMediaError({\n        message: message\n      });\n    }\n  });\n  return _handleRequestPermissionsAsync.apply(this, arguments);\n}\n\nfunction handlePermissionsQueryAsync() {\n  return _handlePermissionsQueryAsync.apply(this, arguments);\n}\n\nfunction _handlePermissionsQueryAsync() {\n  _handlePermissionsQueryAsync = (0, _asyncToGenerator2.default)(function* () {\n    var _navigator, _navigator$permission;\n\n    if (!((_navigator = navigator) != null && (_navigator$permission = _navigator.permissions) != null && _navigator$permission.query)) {\n      throw new _expoModulesCore.UnavailabilityError('expo-barcode-scanner', 'navigator.permissions API is not available');\n    }\n\n    var _yield$navigator$perm = yield navigator.permissions.query({\n      name: 'camera'\n    }),\n        state = _yield$navigator$perm.state;\n\n    switch (state) {\n      case 'prompt':\n        return {\n          status: _expoModulesCore.PermissionStatus.UNDETERMINED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: false\n        };\n\n      case 'granted':\n        return {\n          status: _expoModulesCore.PermissionStatus.GRANTED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: true\n        };\n\n      case 'denied':\n        return {\n          status: _expoModulesCore.PermissionStatus.DENIED,\n          expires: 'never',\n          canAskAgain: true,\n          granted: false\n        };\n    }\n  });\n  return _handlePermissionsQueryAsync.apply(this, arguments);\n}\n\nvar _default = {\n  get name() {\n    return 'ExpoBarCodeScannerModule';\n  },\n\n  get BarCodeType() {\n    return {\n      code39mod43: 'code39mod43',\n      code138: 'code138',\n      interleaved2of5: 'interleaved2of5',\n      aztec: 'aztec',\n      ean13: 'ean13',\n      ean8: 'ean8',\n      qr: 'qr',\n      pdf417: 'pdf417',\n      upc_e: 'upc_e',\n      datamatrix: 'datamatrix',\n      code39: 'code39',\n      code93: 'code93',\n      itf14: 'itf14',\n      codabar: 'codabar',\n      code128: 'code128',\n      upc_a: 'upc_a'\n    };\n  },\n\n  get Type() {\n    return {\n      front: 'front',\n      back: 'back'\n    };\n  },\n\n  requestPermissionsAsync: function () {\n    var _requestPermissionsAsync = (0, _asyncToGenerator2.default)(function* () {\n      return handleRequestPermissionsAsync();\n    });\n\n    function requestPermissionsAsync() {\n      return _requestPermissionsAsync.apply(this, arguments);\n    }\n\n    return requestPermissionsAsync;\n  }(),\n  getPermissionsAsync: function () {\n    var _getPermissionsAsync = (0, _asyncToGenerator2.default)(function* () {\n      return handlePermissionsQueryAsync();\n    });\n\n    function getPermissionsAsync() {\n      return _getPermissionsAsync.apply(this, arguments);\n    }\n\n    return getPermissionsAsync;\n  }()\n};\nexports.default = _default;","map":{"version":3,"sources":["../src/ExpoBarCodeScannerModule.web.ts"],"names":[],"mappings":"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","sourcesContent":["import { PermissionResponse, PermissionStatus, UnavailabilityError } from 'expo-modules-core';\n\nfunction getUserMedia(constraints: MediaStreamConstraints): Promise<MediaStream> {\n  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n    return navigator.mediaDevices.getUserMedia(constraints);\n  }\n\n  // Some browsers partially implement mediaDevices. We can't just assign an object\n  // with getUserMedia as it would overwrite existing properties.\n  // Here, we will just add the getUserMedia property if it's missing.\n\n  // First get ahold of the legacy getUserMedia, if present\n  const getUserMedia =\n    // TODO: this method is deprecated, migrate to https://developer.mozilla.org/en-US/docs/Web/API/MediaDevices/getUserMedia\n    navigator.getUserMedia ||\n    navigator.webkitGetUserMedia ||\n    navigator.mozGetUserMedia ||\n    function () {\n      const error: any = new Error('Permission unimplemented');\n      error.code = 0;\n      error.name = 'NotAllowedError';\n      throw error;\n    };\n\n  return new Promise((resolve, reject) => {\n    getUserMedia.call(navigator, constraints, resolve, reject);\n  });\n}\n\nfunction handleGetUserMediaError({ message }: { message: string }): PermissionResponse {\n  // name: NotAllowedError\n  // code: 0\n  if (message === 'Permission dismissed') {\n    return {\n      status: PermissionStatus.UNDETERMINED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: false,\n    };\n  } else {\n    return {\n      status: PermissionStatus.DENIED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: false,\n    };\n  }\n}\n\nasync function handleRequestPermissionsAsync(): Promise<PermissionResponse> {\n  try {\n    await getUserMedia({\n      video: true,\n    });\n    return {\n      status: PermissionStatus.GRANTED,\n      expires: 'never',\n      canAskAgain: true,\n      granted: true,\n    };\n  } catch ({ message }) {\n    return handleGetUserMediaError({ message });\n  }\n}\n\nasync function handlePermissionsQueryAsync(): Promise<PermissionResponse> {\n  if (!navigator?.permissions?.query) {\n    throw new UnavailabilityError(\n      'expo-barcode-scanner',\n      'navigator.permissions API is not available'\n    );\n  }\n\n  const { state } = await navigator.permissions.query({ name: 'camera' });\n  switch (state) {\n    case 'prompt':\n      return {\n        status: PermissionStatus.UNDETERMINED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: false,\n      };\n    case 'granted':\n      return {\n        status: PermissionStatus.GRANTED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: true,\n      };\n    case 'denied':\n      return {\n        status: PermissionStatus.DENIED,\n        expires: 'never',\n        canAskAgain: true,\n        granted: false,\n      };\n  }\n}\n\nexport default {\n  get name(): string {\n    return 'ExpoBarCodeScannerModule';\n  },\n  get BarCodeType() {\n    return {\n      code39mod43: 'code39mod43',\n      code138: 'code138',\n      interleaved2of5: 'interleaved2of5',\n      aztec: 'aztec',\n      ean13: 'ean13',\n      ean8: 'ean8',\n      qr: 'qr',\n      pdf417: 'pdf417',\n      upc_e: 'upc_e',\n      datamatrix: 'datamatrix',\n      code39: 'code39',\n      code93: 'code93',\n      itf14: 'itf14',\n      codabar: 'codabar',\n      code128: 'code128',\n      upc_a: 'upc_a',\n    };\n  },\n  get Type() {\n    return { front: 'front', back: 'back' };\n  },\n  async requestPermissionsAsync(): Promise<PermissionResponse> {\n    return handleRequestPermissionsAsync();\n  },\n  async getPermissionsAsync(): Promise<PermissionResponse> {\n    return handlePermissionsQueryAsync();\n  },\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"script"}